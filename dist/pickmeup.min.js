/*
 Copyright (c) 2013-2016, Nazar Mokrynskyi
 @copyright Copyright (c) 2008-2009, Stefan Petre
 @license   MIT License, see license.txt
*/
(function(G,x){"function"===typeof define&&define.amd?define(x):"object"===typeof exports?module.exports=x():G.pickmeup=x()})(this,function(){function G(a,c,d){d=d||[];if(a instanceof Element)c.apply(c,[a].concat(d));else{var b,e;b=a.length;for(e=0;e<b;++e)c.apply(c,[a[e]].concat(d))}}function x(a){G(a,function(a){a.parentElement.removeChild(a)})}function J(a,c){do a=a.parentElement;while(a&&!C(a,c));return a}function C(a,c){return(a.matches||a.webkitMatchesSelector||a.msMatchesSelector).call(a,c)}
function n(a,c){return a&&a.classList.contains(c)}function g(a,c){a.classList.add(c)}function r(a,c,d,b){if(-1!==d.indexOf(" ")){d=d.split(" ");var e=d.length,g;for(g=0;g<e;++g)r(a,c,d[g],b)}else a.__pickmeup.events.push([c,d,b]),c.addEventListener(d,b)}function z(a,c,d,b){var e,g,f;if(-1!==d.indexOf(" "))for(e=d.split(" "),g=e.length,f=0;f<g;++f)z(a,c,e[f],b);else for(e=a.__pickmeup.events,g=e.length,f=0;f<g;++f)c&&c!=e[f][0]||d&&d!=e[f][1]||b&&b!=e[f][2]||e[f][0].removeEventListener(e[f][1],e[f][2])}
function M(a){a=a.getBoundingClientRect();return{top:a.top+window.pageYOffset-document.documentElement.clientTop,left:a.left+window.pageXOffset-document.documentElement.clientLeft}}function D(a,c,d){var b=document.createEvent("Event");d&&(b.detail=d);b.initEvent("pickmeup-"+c,!1,!0);return a.dispatchEvent(b)}function K(a){a=new Date(a);for(var c=28,d=a.getMonth();a.getMonth()==d;)++c,a.setDate(c);return c-1}function A(a,c){a.setDate(a.getDate()+c)}function q(a,c){var d=a.getDate();a.setDate(1);a.setMonth(a.getMonth()+
c);a.setDate(Math.min(d,K(a)))}function u(a,c){var d=a.getDate();a.setDate(1);a.setFullYear(a.getFullYear()+c);a.setDate(Math.min(d,K(a)))}function N(a){var c=a.__pickmeup.element,d=a.__pickmeup.options;a=Math.floor(d.calendars/2);var b=d.date,e=d.current,y=d.min?new Date(d.min):null,f=d.max?new Date(d.max):null,h,w,p,k,l;y&&(y.setDate(1),q(y,1),A(y,-1));f&&(f.setDate(1),q(f,1),A(f,-1));x(Array.prototype.slice.call(c.querySelectorAll(".pmu-instance \x3e :not(nav)")));for(var v=0;v<d.calendars;v++){h=
new Date(e);B(h);p=Array.prototype.slice.call(c.querySelectorAll(".pmu-instance"))[v];n(c,"pmu-view-years")?(u(h,12*(v-a)),w=h.getFullYear()-6+" - "+(h.getFullYear()+5)):n(c,"pmu-view-months")?(u(h,v-a),w=h.getFullYear()):n(c,"pmu-view-days")&&(q(h,v-a),w=E(h,d.title_format,d.locales[d.locale]));if(!l&&f&&(l=new Date(h),d.select_day?q(l,d.calendars-1):d.select_month?u(l,d.calendars-1):u(l,12*(d.calendars-1)),l>f)){--v;q(e,-1);l=void 0;continue}l=new Date(h);if(!k&&(k=new Date(h),k.setDate(1),q(k,
1),A(k,-1),y&&y>k)){--v;q(e,1);k=void 0;continue}p.querySelector(".pmu-month").textContent=w;var m=function(a){return"range"==d.mode&&a>=(new Date(b[0])).getFullYear()&&a<=(new Date(b[1])).getFullYear()||"multiple"==d.mode&&-1!==b.reduce(function(a,b){a.push((new Date(b)).getFullYear());return a},[]).indexOf(a)||(new Date(b)).getFullYear()==a},r=function(a,c){var e=(new Date(b[0])).getFullYear(),h=(new Date(b[1])).getFullYear(),g=(new Date(b[0])).getMonth(),f=(new Date(b[1])).getMonth();return"range"==
d.mode&&a>e&&a<h||"range"==d.mode&&a==e&&a<h&&c>=g||"range"==d.mode&&a>e&&a==h&&c<=f||"range"==d.mode&&a==e&&a==h&&c>=g&&c<=f||"multiple"==d.mode&&-1!==b.reduce(function(a,b){b=new Date(b);a.push(b.getFullYear()+"-"+b.getMonth());return a},[]).indexOf(a+"-"+c)||(new Date(b)).getFullYear()==a&&(new Date(b)).getMonth()==c};(function(){var a=[],b=h.getFullYear()-6,c=(new Date(d.min)).getFullYear(),e=(new Date(d.max)).getFullYear(),f,k,l;for(l=0;12>l;++l)f=b+l,k=document.createElement("div"),k.textContent=
f,k.__pickmeup_year=f,d.min&&f<c||d.max&&f>e?g(k,"pmu-disabled"):m(f)&&g(k,"pmu-selected"),a.push(k);p.appendChild(d.instance_content_template(a,"pmu-years"))})();(function(){var a=[],b=h.getFullYear(),c=(new Date(d.min)).getFullYear(),e=(new Date(d.min)).getMonth(),f=(new Date(d.max)).getFullYear(),k=(new Date(d.max)).getMonth(),l,m;for(l=0;12>l;++l)m=document.createElement("div"),m.textContent=d.locales[d.locale].monthsShort[l],m.__pickmeup_month=l,m.__pickmeup_year=b,d.min&&(b<c||l<e&&b==c)||d.max&&
(b>f||l>k&&b>=f)?g(m,"pmu-disabled"):r(b,l)&&g(m,"pmu-selected"),a.push(m);p.appendChild(d.instance_content_template(a,"pmu-months"))})();(function(){var a=[],b=h.getMonth(),c=B(new Date).valueOf(),e,f,l,k,m;(function(){h.setDate(1);var a=(h.getDay()-d.first_day)%7;A(h,-(a+(0>a?7:0)))})();for(e=0;42>e;++e)f=document.createElement("div"),f.textContent=h.getDate(),f.__pickmeup_day=h.getDate(),f.__pickmeup_month=h.getMonth(),f.__pickmeup_year=h.getFullYear(),b!=h.getMonth()&&g(f,"pmu-not-in-month"),
0==h.getDay()?g(f,"pmu-sunday"):6==h.getDay()&&g(f,"pmu-saturday"),l=d.render(new Date(h))||{},k=h.valueOf(),m=d.min&&d.min>h||d.max&&d.max<h,l.disabled||m?g(f,"pmu-disabled"):(l.selected||d.date.valueOf()==k||d.date instanceof Array&&d.date.reduce(function(a,b){return a||k===b.valueOf()},!1)||"range"==d.mode&&k>=d.date[0]&&k<=d.date[1])&&g(f,"pmu-selected"),k==c&&g(f,"pmu-today"),l.class_name&&l.class_name.split(" ").forEach(g.bind(f,f)),a.push(f),A(h,1);p.appendChild(d.instance_content_template(a,
"pmu-days"))})()}k.setDate(1);l.setDate(1);q(l,1);A(l,-1);w=c.querySelector(".pmu-prev");a=c.querySelector(".pmu-next");w&&(w.style.visibility=d.min&&d.min>=k?"hidden":"visible");a&&(a.style.visibility=d.max&&d.max<=l?"hidden":"visible");D(c,"fill")}function t(a,c,d,b){var e;if(a instanceof Date||a instanceof Number)return B(new Date(a));if(!a)return B(new Date);if(a instanceof Array){a=a.slice();for(e=0;e<a.length;++e)a[e]=t(a[e],c,d,b);return a}e=a.split(d);if(1<e.length)return e.forEach(function(a,
e,f){f[e]=t(a.trim(),c,d,b)}),e;e=b.monthsShort.join(")(")+")("+b.months.join(")(");d=new RegExp("[^0-9a-zA-Z("+e+")]+");a=a.split(d);var g=c.split(d),f,h,n,p,k,l=new Date;for(e=0;e<a.length;e++)switch(g[e]){case "b":h=b.monthsShort.indexOf(a[e]);break;case "B":h=b.months.indexOf(a[e]);break;case "d":case "e":f=parseInt(a[e],10);break;case "m":h=parseInt(a[e],10)-1;break;case "Y":case "y":n=parseInt(a[e],10);n+=100<n?0:29>n?2E3:1900;break;case "H":case "I":case "k":case "l":p=parseInt(a[e],10);break;
case "P":case "p":/pm/i.test(a[e])&&12>p?p+=12:/am/i.test(a[e])&&12<=p&&(p-=12);break;case "M":k=parseInt(a[e],10)}f=new Date(void 0===n?l.getFullYear():n,void 0===h?l.getMonth():h,void 0===f?l.getDate():f,void 0===p?l.getHours():p,void 0===k?l.getMinutes():k,0);isNaN(1*f)&&(f=new Date);return B(f)}function B(a){a.setHours(0,0,0,0);return a}function E(a,c,d){var b=a.getMonth(),e=a.getDate(),g=a.getFullYear(),f=a.getDay(),h=a.getHours(),n=12<=h,p=n?h-12:h,k;k=new Date(a.getFullYear(),a.getMonth(),
a.getDate(),0,0,0);var l=new Date(a.getFullYear(),0,0,0,0,0);k=Math.floor((k-l)/24*36E5);0==p&&(p=12);var l=a.getMinutes(),q=a.getSeconds();c=c.split("");for(var m,r=0;r<c.length;r++){m=c[r];switch(m){case "a":m=d.daysShort[f];break;case "A":m=d.days[f];break;case "b":m=d.monthsShort[b];break;case "B":m=d.months[b];break;case "C":m=1+Math.floor(g/100);break;case "d":m=10>e?"0"+e:e;break;case "e":m=e;break;case "H":m=10>h?"0"+h:h;break;case "I":m=10>p?"0"+p:p;break;case "j":m=100>k?10>k?"00"+k:"0"+
k:k;break;case "k":m=h;break;case "l":m=p;break;case "m":m=9>b?"0"+(1+b):1+b;break;case "M":m=10>l?"0"+l:l;break;case "p":case "P":m=n?"PM":"AM";break;case "s":m=Math.floor(a.getTime()/1E3);break;case "S":m=10>q?"0"+q:q;break;case "u":m=f+1;break;case "w":m=f;break;case "y":m=(""+g).substr(2,2);break;case "Y":m=g}c[r]=m}return c.join("")}function O(a,c){var d=a.__pickmeup.element,b=a.__pickmeup.options,e;B(c);a:{var g;switch(b.mode){case "multiple":g=c.valueOf();for(e=0;e<b.date.length;++e)if(b.date[e].valueOf()===
g){b.date.splice(e,1);break a}b.date.push(c);break;case "range":b.lastSel||(b.date[0]=c);c<=b.date[0]?(b.date[1]=b.date[0],b.date[0]=c):b.date[1]=c;b.lastSel=!b.lastSel;break;default:b.date=c.valueOf()}}c=H(b);C(a,"input")&&(a.value="single"==b.mode?c.formatted_date:c.formatted_date.join(b.separator));D(d,"change",c);if(!b.flat&&b.hide_on_select&&("range"!=b.mode||!b.lastSel))return b.bound.hide(),!1}function P(a,c){c=c.target;n(c,"pmu-button")||(c=J(c,".pmu-button"));if(!n(c,"pmu-button")||n(c,"pmu-disabled"))return!1;
a=a.__pickmeup.options;var d=J(c,".pmu-instance"),b=d.parentElement,d=Array.prototype.slice.call(b.querySelectorAll(".pmu-instance")).indexOf(d);C(c.parentElement,"nav")?n(c,"pmu-month")?(q(a.current,d-Math.floor(a.calendars/2)),n(b,"pmu-view-years")?(a.current="single"!=a.mode?new Date(a.date[a.date.length-1]):new Date(a.date),a.select_day?(b.classList.remove("pmu-view-years"),g(b,"pmu-view-days")):a.select_month&&(b.classList.remove("pmu-view-years"),g(b,"pmu-view-months"))):n(b,"pmu-view-months")?
a.select_year?(b.classList.remove("pmu-view-months"),g(b,"pmu-view-years")):a.select_day&&(b.classList.remove("pmu-view-months"),g(b,"pmu-view-days")):n(b,"pmu-view-days")&&(a.select_month?(b.classList.remove("pmu-view-days"),g(b,"pmu-view-months")):a.select_year&&(b.classList.remove("pmu-view-days"),g(b,"pmu-view-years")))):n(c,"pmu-prev")?a.bound.prev(!1):a.bound.next(!1):n(b,"pmu-view-years")?(a.current.setFullYear(c.__pickmeup_year),a.select_month?(b.classList.remove("pmu-view-years"),g(b,"pmu-view-months")):
a.select_day?(b.classList.remove("pmu-view-years"),g(b,"pmu-view-days")):a.bound.update_date(a.current)):n(b,"pmu-view-months")?(a.current.setMonth(c.__pickmeup_month),a.current.setFullYear(c.__pickmeup_year),a.select_day?(b.classList.remove("pmu-view-months"),g(b,"pmu-view-days")):a.bound.update_date(a.current),q(a.current,Math.floor(a.calendars/2)-d)):(b=new Date(a.current),b.setYear(c.__pickmeup_year),b.setMonth(c.__pickmeup_month),b.setDate(c.__pickmeup_day),a.bound.update_date(b));a.bound.fill();
return!0}function H(a){var c;if("single"==a.mode)return c=new Date(a.date),{formatted_date:E(c,a.format,a.locales[a.locale]),date:c};c={formatted_date:[],date:[]};a.date.forEach(function(d){d=new Date(d);c.formatted_date.push(E(d,a.format,a.locales[a.locale]));c.date.push(d)});return c}function I(a,c){var d=a.__pickmeup.element;if(c||n(d,"pmu-hidden")){var b=a.__pickmeup.options,e=M(a),g=window.pageXOffset,f=window.pageYOffset,h=document.documentElement.clientWidth,q=document.documentElement.clientHeight,
p=e.top,k=e.left;b.bound.fill();C(a,"input")&&((c=a.value)&&b.bound.set_date(c),r(a,a,"keydown",function(a){9==a.which&&b.bound.hide()}),b.lastSel=!1);if(D(d,"show")&&!b.flat){switch(b.position){case "top":p-=d.offsetHeight;break;case "left":k-=d.offsetWidth;break;case "right":k+=a.offsetWidth;break;case "bottom":p+=a.offsetHeight}p+d.offsetHeight>f+q&&(p=e.top-d.offsetHeight);p<f&&(p=e.top+a.offsetHeight);k+d.offsetWidth>g+h&&(k=e.left-d.offsetWidth);k<g&&(k=e.left+a.offsetWidth);d.style.top=p+"px";
d.style.left=k+"px";d.classList.remove("pmu-hidden");r(a,document.documentElement,"click",b.bound.hide);r(a,window,"resize",b.bound.forced_show)}}}function Q(a,c){var d=a.__pickmeup.element,b=a.__pickmeup.options;c&&c.target&&(c.target==a||d.compareDocumentPosition(c.target)&16)||!D(d,"hide")||(g(d,"pmu-hidden"),z(a,document.documentElement,"click",b.bound.hide),z(a,window,"resize",b.bound.forced_show),b.lastSel=!1)}function R(a){var c=a.__pickmeup.options;z(a,document.documentElement,"click",c.bound.hide);
z(a,window,"resize",c.bound.forced_show);c.bound.forced_show()}function S(a){a=a.__pickmeup.options;"single"!=a.mode&&(a.date=[],a.lastSel=!1,a.bound.fill())}function T(a,c){"undefined"==typeof c&&(c=!0);var d=a.__pickmeup.element;a=a.__pickmeup.options;n(d,"pmu-view-years")?u(a.current,-12):n(d,"pmu-view-months")?u(a.current,-1):n(d,"pmu-view-days")&&q(a.current,-1);c&&a.bound.fill()}function U(a,c){"undefined"==typeof c&&(c=!0);var d=a.__pickmeup.element;a=a.__pickmeup.options;n(d,"pmu-view-years")?
u(a.current,12):n(d,"pmu-view-months")?u(a.current,1):n(d,"pmu-view-days")&&q(a.current,1);c&&a.bound.fill()}function V(a,c){var d=a.__pickmeup.options;a=H(d);return"string"===typeof c?(a=a.date,a instanceof Date?E(a,c,d.locales[d.locale]):a.map(function(a){return E(a,c,d.locales[d.locale])})):a[c?"formatted_date":"date"]}function W(a,c,d){var b=a.__pickmeup.options;if(!(c instanceof Array)||0<c.length)if(b.date=t(c,b.format,b.separator,b.locales[b.locale]),"single"!=b.mode)for(b.date instanceof Array?
(b.date[0]=b.date[0]||t(new Date,b.format,b.separator,b.locales[b.locale]),"range"==b.mode&&(b.date[1]=b.date[1]||t(b.date[0],b.format,b.separator,b.locales[b.locale]))):(b.date=[b.date],"range"==b.mode&&b.date.push(t(b.date[0],b.format,b.separator,b.locales[b.locale]))),c=0;c<b.date.length;++c)b.date[c]=L(b.date[c],b.min,b.max);else b.date instanceof Array&&(b.date=b.date[0]),b.date=L(b.date,b.min,b.max);else b.date=[];if(!b.select_day)if(b.date instanceof Array)for(c=0;c<b.date.length;++c)b.date[c].setDate(1);
else b.date.setDate(1);if("multiple"==b.mode)for(c=0;c<b.date.length;++c)b.date.indexOf(b.date[c])!==c&&(b.date.splice(c,1),--c);d?b.current=t(d,b.format,b.separator,b.locales[b.locale]):(d="single"===b.mode?b.date:b.date[b.date.length-1],b.current=d?new Date(d):new Date);b.current.setDate(1);b.bound.fill();C(a,"input")&&!1!==b.default_date&&(d=H(b),c=a.value,b="single"==b.mode?d.formatted_date:d.formatted_date.join(b.separator),c||D(a.__pickmeup.element,"change",d),c!=b&&(a.value=b))}function X(a){var c=
a.__pickmeup.element;z(a);x(c);delete a.__pickmeup}function L(a,c,d){return c&&c>a?new Date(c):d&&d<a?new Date(d):a}function F(a,c){"string"==typeof a&&(a=document.querySelector(a));if(!a.__pickmeup){var d,b={};for(d in F.defaults)b[d]=d in c?c[d]:F.defaults[d];for(d in b)c=a.getAttribute("pmu-"+d),null!==c&&(b[d]=c);"days"!=b.view||b.select_day||(b.view="months");"months"!=b.view||b.select_month||(b.view="years");"years"!=b.view||b.select_year||(b.view="days");"days"!=b.view||b.select_day||(b.view=
"months");b.calendars=Math.max(1,parseInt(b.calendars,10)||1);b.mode=/single|multiple|range/.test(b.mode)?b.mode:"single";b.min&&(b.min=t(b.min,b.format,b.separator,b.locales[b.locale]),b.select_day||b.min.setDate(1));b.max&&(b.max=t(b.max,b.format,b.separator,b.locales[b.locale]),b.select_day||b.max.setDate(1));d=document.createElement("div");a.__pickmeup={options:b,events:[],element:d};d.__pickmeup_target=a;g(d,"pickmeup");b.class_name&&g(d,b.class_name);b.bound={fill:N.bind(a,a),update_date:O.bind(a,
a),click:P.bind(a,a),show:I.bind(a,a),forced_show:I.bind(a,a,!0),hide:Q.bind(a,a),update:R.bind(a,a),clear:S.bind(a,a),prev:T.bind(a,a),next:U.bind(a,a),get_date:V.bind(a,a),set_date:W.bind(a,a),destroy:X.bind(a,a)};g(d,"pmu-view-"+b.view);d.innerHTML=b.instance_template(b).repeat(b.calendars);r(a,d,"click",b.bound.click);r(a,d,"onselectstart"in Element.prototype?"selectstart":"mousedown",function(a){a.preventDefault()});b.flat?(g(d,"pmu-flat"),a.appendChild(d)):(g(d,"pmu-hidden"),document.body.appendChild(d),
r(a,a,"click",I.bind(a,a,!1)),r(a,a,"input",b.bound.update),r(a,a,"change",b.bound.update));b.bound.set_date(b.date,b.current)}b=a.__pickmeup.options;return{hide:b.bound.hide,show:b.bound.show,clear:b.bound.clear,update:b.bound.update,prev:b.bound.prev,next:b.bound.next,get_date:b.bound.get_date,set_date:b.bound.set_date,destroy:b.bound.destroy}}F.defaults={current:null,date:new Date,default_date:new Date,flat:!1,first_day:1,prev:"\x26#9664;",next:"\x26#9654;",mode:"single",select_year:!0,select_month:!0,
select_day:!0,view:"days",calendars:1,format:"d-m-Y",title_format:"B, Y",position:"bottom",class_name:"",separator:" - ",hide_on_select:!1,min:null,max:null,render:function(){},locale:"en",locales:{en:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat".split(" "),daysMin:"Su Mo Tu We Th Fr Sa".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}},
instance_template:function(a){var c=a.locales[a.locale].daysMin.slice();a.first_day&&c.push(c.shift());return'\x3cdiv class\x3d"pmu-instance"\x3e\x3cnav\x3e\x3cdiv class\x3d"pmu-prev pmu-button"\x3e'+a.prev+'\x3c/div\x3e\x3cdiv class\x3d"pmu-month pmu-button"\x3e\x3c/div\x3e\x3cdiv class\x3d"pmu-next pmu-button"\x3e'+a.next+'\x3c/div\x3e\x3c/nav\x3e\x3cnav class\x3d"pmu-day-of-week"\x3e\x3cdiv\x3e'+c.join("\x3c/div\x3e\x3cdiv\x3e")+"\x3c/div\x3e\x3c/nav\x3e\x3c/div\x3e"},instance_content_template:function(a,
c){var d=document.createElement("div");g(d,c);for(c=0;c<a.length;++c)g(a[c],"pmu-button"),d.appendChild(a[c]);return d}};return F});