/**
 * @package		PickMeUp - jQuery datepicker plugin
 * @author		Nazar Mokrynskyi <nazar@mokrynskyi.com>
 * @author		Stefan Petre <www.eyecon.ro>
 * @copyright	Copyright (c) 2013, Nazar Mokrynskyi
 * @copyright	Copyright (c) 2008-2009, Stefan Petre
 * @license		MIT License, see license.txt
 */
(function(e){function m(){for(var e=new Date(this.toString()),f=28,m=e.getMonth();e.getMonth()==m;){++f,e.setDate(f);}return f-1;}e.addDays=function(e){this.setDate(this.getDate()+e);};e.addMonths=function(e){var f=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+e);this.setDate(Math.min(f,m.apply(this)));};e.addYears=function(e){var f=this.getDate();this.setDate(1);this.setFullYear(this.getFullYear()+e);this.setDate(Math.min(f,m.apply(this)));};e.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0),f=new Date(this.getFullYear(),0,0,0,0,0);return Math.floor((e-f)/24*3600000);};})(Date.prototype);(function(e){e.pickmeup={flat:!1,first_day:1,prev:"&#9664;",next:"&#9654;",mode:"single",view:"days",calendars:1,format:"d-m-Y",position:"bottom",trigger_event:"click",class_name:"",render:function(){},change:function(){return !0;},before_show:function(){return !0;},show:function(){return !0;},hide:function(){return !0;},locale:{days:"Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),daysShort:"Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),daysMin:"Su Mo Tu We Th Fr Sa Su".split(" "),months:"January February March April May June July August September October November December".split(" "),monthsShort:"Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" ")}};var m=function(){function m(b){var a=b.data("pickmeup"),c=Math.floor(a.calendars/2),d,l,q,g,h,r=0,p,n;b.find(".pmu-instance > :not(nav)").remove();for(var f=0;f<a.calendars;f++){d=new Date(a.current);n=b.find(".pmu-instance").eq(f);b.hasClass("pmu-view-years")?(d.addYears(12*(f-c)),q=d.getFullYear()-6+" - "+(d.getFullYear()+5)):b.hasClass("pmu-view-months")?(d.addYears(f-c),q=d.getFullYear()):b.hasClass("pmu-view-days")&&(d.addMonths(f-c),q=v(d,"B, Y",a.locale));n.find(".pmu-month").text(q);g=d.getFullYear()-6;l={data:[],class_name:"pmu-years"};for(h=0;12>h;h++){l.data.push(g+h);}p=u.months(l);d.setDate(1);l=[];h=d.getMonth();g=(d.getDay()-a.first_day)%7;d.addDays(-(g+(0>g?7:0)));for(r=0;42>r;){g={text:d.getDate(),class_name:[]};h!=d.getMonth()&&g.class_name.push("pmu-not-in-month");0==d.getDay()?g.class_name.push("pmu-sunday"):6==d.getDay()&&g.class_name.push("pmu-saturday");var t=a.render(d)||{},k=d.valueOf();(t.selected||a.date==k||-1<e.inArray(k,a.date)||"range"==a.mode&&k>=a.date[0]&&k<=a.date[1])&&g.class_name.push("pmu-selected");t.disabled&&g.class_name.push("pmu-disabled");t.class_name&&g.class_name.push(t.class_name);g.class_name=g.class_name.join(" ");l.push(g);d.addDays(1);r++;}p=u.days(l)+p;l={data:a.locale.monthsShort,class_name:"pmu-months"};p=u.months(l)+p;n.append(p);}}function f(b,a){if(b.constructor==Date){return b;}for(var c=b.split(/\W+/),d=a.split(/\W+/),l,e,g,h,f,p=new Date,n=0;n<c.length;n++){switch(d[n]){case"d":case"e":l=parseInt(c[n],10);break;case"m":e=parseInt(c[n],10)-1;break;case"Y":case"y":g=parseInt(c[n],10);g+=100<g?0:29>g?2000:1900;break;case"H":case"I":case"k":case"l":h=parseInt(c[n],10);break;case"P":case"p":/pm/i.test(c[n])&&12>h?h+=12:/am/i.test(c[n])&&12<=h&&(h-=12);break;case"M":f=parseInt(c[n],10);}}return new Date(void 0===g?p.getFullYear():g,void 0===e?p.getMonth():e,void 0===l?p.getDate():l,void 0===h?p.getHours():h,void 0===f?p.getMinutes():f,0);}function v(b,a,c){var d=b.getMonth(),e=b.getDate(),q=b.getFullYear(),g=b.getDay(),h=b.getHours(),f=12<=h,p=f?h-12:h,n=b.getDayOfYear();0==p&&(p=12);var m=b.getMinutes(),t=b.getSeconds();a=a.split("");for(var k,s=0;s<a.length;s++){k=a[s];switch(k){case"a":k=c.daysShort[g];break;case"A":k=c.days[g];break;case"b":k=c.monthsShort[d];break;case"B":k=c.months[d];break;case"C":k=1+Math.floor(q/100);break;case"d":k=10>e?"0"+e:e;break;case"e":k=e;break;case"H":k=10>h?"0"+h:h;break;case"I":k=10>p?"0"+p:p;break;case"j":k=100>n?10>n?"00"+n:"0"+n:n;break;case"k":k=h;break;case"l":k=p;break;case"m":k=9>d?"0"+(1+d):1+d;break;case"M":k=10>m?"0"+m:m;break;case"p":case"P":k=f?"PM":"AM";break;case"s":k=Math.floor(b.getTime()/1000);break;case"S":k=10>t?"0"+t:t;break;case"u":k=g+1;break;case"w":k=g;break;case"y":k=(""+q).substr(2,2);break;case"Y":k=q;}a[s]=k;}return a.join("");}function y(b){var a=e(b.target);if(a.hasClass("pmu-button")){if(a.hasClass("pmu-disabled")){return !1;}var c=e(this).data("pickmeup"),d=a.parents(".pmu-instance").eq(0);b=d.parent();var l=e(".pmu-instance",b).index(d),f=new Date(c.current),g;if(a.parent().is("nav")){a.hasClass("pmu-month")?(f.addMonths(l-Math.floor(c.calendars/2)),b.hasClass("pmu-view-years")?(b.removeClass("pmu-view-years").addClass("pmu-view-days"),a.text(v(f,"B, Y",c.locale))):b.hasClass("pmu-view-months")?(b.removeClass("pmu-view-months").addClass("pmu-view-years"),a.text(f.getFullYear()-6+" - "+(f.getFullYear()+5))):b.hasClass("pmu-view-days")&&(b.removeClass("pmu-view-days").addClass("pmu-view-months"),a.text(f.getFullYear()))):(a=a.hasClass("pmu-prev"),b.hasClass("pmu-view-years")?c.current.addYears(a?-12:12):b.hasClass("pmu-view-months")?c.current.addYears(a?-1:1):b.hasClass("pmu-view-days")&&c.current.addMonths(a?-1:1));}else{if(!a.hasClass("pmu-disabled")){if(b.hasClass("pmu-view-years")){c.current.setFullYear(parseInt(a.text(),10)),b.removeClass("pmu-view-years").addClass("pmu-view-months");}else{if(b.hasClass("pmu-view-months")){c.current.setMonth(d.find(".pmu-months .pmu-button").index(a)),c.current.setFullYear(parseInt(d.find(".pmu-month").text(),10)),c.current.addMonths(Math.floor(c.calendars/2)-l),b.removeClass("pmu-view-months").addClass("pmu-view-days");}else{g=parseInt(a.text(),10);f.addMonths(l-Math.floor(c.calendars/2));a.hasClass("pmu-not-in-month")&&f.addMonths(15<g?-1:1);f.setDate(g);switch(c.mode){case"multiple":g=f.setHours(0,0,0,0).valueOf();-1<e.inArray(g,c.date)?e.each(c.date,function(a,b){return b==g?(c.date.splice(a,1),!1):!0;}):c.date.push(g);break;case"range":c.lastSel||(c.date[0]=f.setHours(0,0,0,0).valueOf());g=f.setHours(23,59,59,0).valueOf();g<c.date[0]?(c.date[1]=c.date[0]+86399000,c.date[0]=g-86399000):c.date[1]=g;c.lastSel=!c.lastSel;break;default:c.date=f.valueOf();}c.change.apply(this,x(c));}}}}m(b);}return !1;}function x(b){var a;if("single"==b.mode){return a=new Date(b.date),[v(a,b.format,b.locale),a];}a=[[],[]];e.each(b.date,function(c,d){var e=new Date(d);a[0].push(v(e,b.format,b.locale));a[1].push(e);});return a;}function s(b){var a=this.pickmeup;if(b||!a.is(":visible")){m(a);b=a.data("pickmeup");var c=e(this).offset(),d=document.documentElement.scrollLeft,f=document.documentElement.scrollTop,q=document.documentElement.clientWidth,g=document.documentElement.clientHeight,h=c.top,r=c.left;b.before_show.call(this,a);switch(b.position){case"top":h-=a.offsetHeight;break;case"left":r-=a.offsetWidth;break;case"right":r+=this.offsetWidth;break;case"bottom":h+=this.offsetHeight;}h+a.offsetHeight>f+g&&(h=c.top-a.offsetHeight);h<f&&(h=c.top+this.offsetHeight+a.offsetHeight);r+a.offsetWidth>d+q&&(r=c.left-a.offsetWidth);r<d&&(r=c.left+this.offsetWidth);!1!=b.show.call(this,a)&&a.css({display:"inline-block",top:h+"px",left:r+"px"});e(document).on("mousedown",{cal:a,trigger:this},w).on("resize",[!0],s);}}function w(b){if(!b.target||b.target!=b.data.trigger&&!(b.data.cal.get(0).compareDocumentPosition(b.target)&16)){b=b.data.cal;var a=b.data("pickmeup");!1!=a.hide.apply(this,b)&&(b.hide(),e(document).off("mousedown",w).off("resize",s),a.date[1]=a.date[0],a.lastSel=!1);}}var z={years:"pmu-view-years",moths:"pmu-view-months",days:"pmu-view-days"},u={wrapper:'<div class="pickmeup" />',head:function(b){for(var a="",c=0;7>c;++c){a+="<div>"+b.day[c]+"</div>";}return'<div class="pmu-instance"><nav><div class="pmu-prev pmu-button">'+b.prev+'</div><div class="pmu-month pmu-button" /><div class="pmu-next pmu-button">'+b.next+'</div></nav><nav class="pmu-day-of-week">'+a+"</nav></div>";},days:function(b){for(var a="",c=0;42>c;++c){a+='<div class="'+b[c].class_name+' pmu-button">'+b[c].text+"</div>";}return'<div class="pmu-days">'+a+"</div>";},months:function(b){for(var a="",c=0;12>c;++c){a+='<div class="pmu-button">'+b.data[c]+"</div>";}return'<div class="'+b.class_name+'">'+a+"</div>";}};return{init:function(b){b=e.extend({},e.pickmeup,b||{});b.calendars=Math.max(1,parseInt(b.calendars,10)||1);b.mode=/single|multiple|range/.test(b.mode)?b.mode:"single";return this.each(function(){var a=e.extend({},b);if(!e(this).data("pickmeup")){var c;a.date?a.date.constructor==String&&(a.date=f(a.date,a.format),a.date.setHours(0,0,0,0)):a.date=new Date;if("single"!=a.mode){if(a.date.constructor!=Array){a.date=[a.date.valueOf()],"range"==a.mode&&a.date.push((new Date(a.date[0])).setHours(23,59,59,0).valueOf());}else{for(c=0;c<a.date.length;c++){a.date[c]=f(a.date[c],a.format).setHours(0,0,0,0).valueOf();}"range"==a.mode&&(a.date[1]=(new Date(a.date[1])).setHours(23,59,59,0).valueOf());}}else{a.date=a.date.valueOf();}a.current=a.current?f(a.current,a.format):new Date;a.current.setDate(1);a.current.setHours(0,0,0,0);var d,l=e(u.wrapper).on("click",y).data("pickmeup",a);a.class_name&&l.addClass(a.class_name);var q="";for(c=0;c<a.calendars;c++){d=a.first_day,q+=u.head({prev:a.prev,next:a.next,day:[a.locale.daysMin[d++%7],a.locale.daysMin[d++%7],a.locale.daysMin[d++%7],a.locale.daysMin[d++%7],a.locale.daysMin[d++%7],a.locale.daysMin[d++%7],a.locale.daysMin[d++%7]]});}l.addClass(z[a.view]).append(q);m(l);this.pickmeup=l;a.flat?l.appendTo(this).css({position:"relative",display:"inline-block"}):(l.appendTo(document.body),e(this).on(a.trigger_event,s));}});},show:function(){return this.each(function(){this.pickmeup&&s.apply(this);});},hide:function(){return this.each(function(){this.pickmeup&&w.call(this,{data:{cal:this.pickmeup}});});},update:function(){return this.each(function(){this.pickmeup&&(e(document).off("mousedown",w).off("resize",s),s.call(this,!0));});},set_date:function(b,a){return this.each(function(){if(this.pickmeup){var c=this.pickmeup,d=c.data("pickmeup");d.date=b;d.date.constructor==String&&(d.date=f(d.date,d.format),d.date.setHours(0,0,0,0));if("single"!=d.mode){if(d.date.constructor!=Array){d.date=[d.date.valueOf()],"range"==d.mode&&d.date.push((new Date(d.date[0])).setHours(23,59,59,0).valueOf());}else{for(var e=0;e<d.date.length;e++){d.date[e]=f(d.date[e],d.format).setHours(0,0,0,0).valueOf();}"range"==d.mode&&(d.date[1]=(new Date(d.date[1])).setHours(23,59,59,0).valueOf());}}else{d.date=d.date.valueOf();}a&&(d.current=new Date("single"!=d.mode?d.date[0]:d.date));m(c);}});},get_date:function(b){return this[0].pickmeup?x(this[0].pickmeup.data("pickmeup"))[b?0:1]:0;},clear:function(){return this.each(function(){if(this.pickmeup){var b=this.pickmeup,a=b.data("pickmeup");"single"!=a.mode&&(a.date=[],m(b));}});}};}();e.fn.pickmeup=function(e){if("string"!==typeof e){m.init.apply(this,Array.prototype.slice.call(arguments));}else{switch(e){case"hide":return m.hide.apply(this);case"show":return m.show.apply(this);case"get_date":return m.get_date.apply(this,Array.prototype.slice.call(arguments,1));case"set_date":return m.set_date.apply(this,Array.prototype.slice.call(arguments,1));case"clear":return m.clear.apply(this);case"update":return m.update.apply(this);}}return this;};})(jQuery);